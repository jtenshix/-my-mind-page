<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
  <h1>Notas</h1>
  <textarea id="note" placeholder="Escribe tu nota aquÃ­..."></textarea><br>
  <input type="text" id="imageUrl" placeholder="URL de la imagen"><br>
  <button onclick="saveNote()">Guardar Nota</button>
  <button onclick="loadNotes()">Cargar Notas</button>
  <div id="notes"></div>

  <script>
    function saveNote() {
      var note = document.getElementById('note').value;
      var imageUrl = document.getElementById('imageUrl').value;
      google.script.run.withSuccessHandler(function(row) {
        alert('Nota guardada en la fila ' + row);
        loadNotes();
      }).saveNote(note, imageUrl);
    }

    function loadNotes() {
      google.script.run.withSuccessHandler(function(notes) {
        var notesDiv = document.getElementById('notes');
        notesDiv.innerHTML = '';
        notes.forEach(function(note) {
          var noteDiv = document.createElement('div');
          noteDiv.innerHTML = '<p>' + note.note + '</p>';
          if (note.imageUrl) {
            noteDiv.innerHTML += '<img src="' + note.imageUrl + '" width="100">';
          }
          noteDiv.innerHTML += '<button onclick="deleteNote(' + note.row + ')">Eliminar</button>';
          notesDiv.appendChild(noteDiv);
        });
      }).getNotes();
    }

    function deleteNote(row) {
      google.script.run.withSuccessHandler(function() {
        alert('Nota eliminada');
        loadNotes();
      }).deleteNote(row);
    }
  </script>
</body>
</html>
